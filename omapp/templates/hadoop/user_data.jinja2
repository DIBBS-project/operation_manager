#!/bin/bash

# Configure SSH to accept a new key
mkdir -p /home/{{ user }}/.ssh
echo "{{ public_key }}" >> /home/{{ user }}/.ssh/authorized_keys

sudo yum-config-manager --add-repo http://mirror.centos.org/centos/7/os/x86_64/
sudo yum-config-manager --add-repo http://mirror.centos.org/centos/7/updates/x86_64/
sudo yum-config-manager --add-repo http://mirror.centos.org/centos/7/extras/x86_64/
sudo yum-config-manager --add-repo http://mirror.centos.org/centos/7/centosplus/x86_64/

cat >> /etc/yum.conf <<- EOM
timeout=5
EOM

sudo yum update
